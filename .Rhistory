## Get training data
trainURL <- "http://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv"
training <- read.csv(url(trainURL), na.strings=c("NA","#DIV/0!",""))
library(ISLR); library(ggplot2); library(caret)
data <- training
myinTrain <- createDataPartition(y=data$classe, p=0.7, list=FALSE)
mytrain <- data[myinTrain,]
mytest <- data[-myinTrain,]
dim(mytrain); dim(mytest)
orig <- c("classe", "roll_belt", "roll_arm", "roll_dumbbell", "roll_forearm",
"pitch_belt", "pitch_arm", "pitch_dumbbell", "pitch_forearm",
"yaw_belt", "yaw_arm", "yaw_dumbbell", "yaw_forearm",
"amplitude_roll_belt", "amplitude_roll_arm", "amplitude_roll_dumbbell", "amplitude_roll_forearm",
"amplitude_pitch_belt", "amplitude_pitch_arm", "amlitude_pitch_dumbbell", "amplitude_pitch_forearm",
"amplitude_yaw_belt", "amplitude_yaw_arm", "amlitude_yaw_dumbbell", "amplitude_yaw_forearm",
"gyros_belt_x", "gyros_arm_x", "gyros_dumbbell_x", "gyros_forearm_x",
"gyros_belt_y", "gyros_arm_y", "gyros_dumbbell_y", "gyros_forearm_y",
"gyros_belt_z", "gyros_arm_z", "gyros_dumbbell_z", "gyros_forearm_z",
"accel_belt_x", "accel_arm_x", "accel_dumbbell_x", "accel_forearm_x",
"accel_belt_y", "accel_arm_y", "accel_dumbbell_y", "accel_forearm_y",
"accel_belt_z", "accel_arm_z", "accel_dumbbell_z", "accel_forearm_z",
"magnet_belt_x", "magnet_arm_x", "magnet_dumbbell_x", "magnet_forearm_x",
"magnet_belt_y", "magnet_arm_y", "magnet_dumbbell_y", "magnet_forearm_y",
"magnet_belt_z", "magnet_arm_z", "magnet_dumbbell_z", "magnet_forearm_z",)
orig <- c("classe", "roll_belt", "roll_arm", "roll_dumbbell", "roll_forearm",
"pitch_belt", "pitch_arm", "pitch_dumbbell", "pitch_forearm",
"yaw_belt", "yaw_arm", "yaw_dumbbell", "yaw_forearm",
"amplitude_roll_belt", "amplitude_roll_arm", "amplitude_roll_dumbbell", "amplitude_roll_forearm",
"amplitude_pitch_belt", "amplitude_pitch_arm", "amlitude_pitch_dumbbell", "amplitude_pitch_forearm",
"amplitude_yaw_belt", "amplitude_yaw_arm", "amlitude_yaw_dumbbell", "amplitude_yaw_forearm",
"gyros_belt_x", "gyros_arm_x", "gyros_dumbbell_x", "gyros_forearm_x",
"gyros_belt_y", "gyros_arm_y", "gyros_dumbbell_y", "gyros_forearm_y",
"gyros_belt_z", "gyros_arm_z", "gyros_dumbbell_z", "gyros_forearm_z",
"accel_belt_x", "accel_arm_x", "accel_dumbbell_x", "accel_forearm_x",
"accel_belt_y", "accel_arm_y", "accel_dumbbell_y", "accel_forearm_y",
"accel_belt_z", "accel_arm_z", "accel_dumbbell_z", "accel_forearm_z",
"magnet_belt_x", "magnet_arm_x", "magnet_dumbbell_x", "magnet_forearm_x",
"magnet_belt_y", "magnet_arm_y", "magnet_dumbbell_y", "magnet_forearm_y",
"magnet_belt_z", "magnet_arm_z", "magnet_dumbbell_z", "magnet_forearm_z")
mytrainraw <- mytrain[,orig]
mytrainraw <- mytrain[,mytrain$orig]
orig <- c("mytrain$classe", "mytrain$roll_belt", "mytrain$roll_arm", "mytrain$roll_dumbbell", "mytrain$roll_forearm",
"mytrain$pitch_belt", "mytrain$pitch_arm", "mytrain$pitch_dumbbell", "mytrain$pitch_forearm",
"mytrain$yaw_belt", "mytrain$yaw_arm", "mytrain$yaw_dumbbell", "mytrain$yaw_forearm",
"mytrain$amplitude_roll_belt", "mytrain$amplitude_roll_arm", "mytrain$amplitude_roll_dumbbell", "mytrain$amplitude_roll_forearm",
"mytrain$amplitude_pitch_belt", "mytrain$amplitude_pitch_arm", "mytrain$amlitude_pitch_dumbbell", "mytrain$amplitude_pitch_forearm",
"mytrain$amplitude_yaw_belt", "mytrain$amplitude_yaw_arm", "mytrain$amlitude_yaw_dumbbell", "mytrain$amplitude_yaw_forearm",
"mytrain$gyros_belt_x", "mytrain$gyros_arm_x", "mytrain$gyros_dumbbell_x", "mytrain$gyros_forearm_x",
"mytrain$gyros_belt_y", "mytrain$gyros_arm_y", "mytrain$gyros_dumbbell_y", "mytrain$gyros_forearm_y",
"mytrain$gyros_belt_z", "mytrain$gyros_arm_z", "mytrain$gyros_dumbbell_z", "mytrain$gyros_forearm_z",
"mytrain$accel_belt_x", "mytrain$accel_arm_x", "mytrain$accel_dumbbell_x", "mytrain$accel_forearm_x",
"mytrain$accel_belt_y", "mytrain$accel_arm_y", "mytrain$accel_dumbbell_y", "mytrain$accel_forearm_y",
"mytrain$accel_belt_z", "mytrain$accel_arm_z", "mytrain$accel_dumbbell_z", "mytrain$accel_forearm_z",
"mytrain$magnet_belt_x", "mytrain$magnet_arm_x", "mytrain$magnet_dumbbell_x", "mytrain$magnet_forearm_x",
"mytrain$magnet_belt_y", "mytrain$magnet_arm_y", "mytrain$magnet_dumbbell_y", "mytrain$magnet_forearm_y",
"mytrain$magnet_belt_z", "mytrain$magnet_arm_z", "mytrain$magnet_dumbbell_z", "mytrain$magnet_forearm_z")
mytrainraw <- mytrain[,orig]
mytrainraw <- mytrain[,"orig"]
mytrainraw <- mytrain[,c("mytrain$classe", "mytrain$roll_belt", "mytrain$roll_arm", "mytrain$roll_dumbbell", "mytrain$roll_forearm",
"mytrain$pitch_belt", "mytrain$pitch_arm", "mytrain$pitch_dumbbell", "mytrain$pitch_forearm",
"mytrain$yaw_belt", "mytrain$yaw_arm", "mytrain$yaw_dumbbell", "mytrain$yaw_forearm",
"mytrain$amplitude_roll_belt", "mytrain$amplitude_roll_arm", "mytrain$amplitude_roll_dumbbell", "mytrain$amplitude_roll_forearm",
"mytrain$amplitude_pitch_belt", "mytrain$amplitude_pitch_arm", "mytrain$amlitude_pitch_dumbbell", "mytrain$amplitude_pitch_forearm",
"mytrain$amplitude_yaw_belt", "mytrain$amplitude_yaw_arm", "mytrain$amlitude_yaw_dumbbell", "mytrain$amplitude_yaw_forearm",
"mytrain$gyros_belt_x", "mytrain$gyros_arm_x", "mytrain$gyros_dumbbell_x", "mytrain$gyros_forearm_x",
"mytrain$gyros_belt_y", "mytrain$gyros_arm_y", "mytrain$gyros_dumbbell_y", "mytrain$gyros_forearm_y",
"mytrain$gyros_belt_z", "mytrain$gyros_arm_z", "mytrain$gyros_dumbbell_z", "mytrain$gyros_forearm_z",
"mytrain$accel_belt_x", "mytrain$accel_arm_x", "mytrain$accel_dumbbell_x", "mytrain$accel_forearm_x",
"mytrain$accel_belt_y", "mytrain$accel_arm_y", "mytrain$accel_dumbbell_y", "mytrain$accel_forearm_y",
"mytrain$accel_belt_z", "mytrain$accel_arm_z", "mytrain$accel_dumbbell_z", "mytrain$accel_forearm_z",
"mytrain$magnet_belt_x", "mytrain$magnet_arm_x", "mytrain$magnet_dumbbell_x", "mytrain$magnet_forearm_x",
"mytrain$magnet_belt_y", "mytrain$magnet_arm_y", "mytrain$magnet_dumbbell_y", "mytrain$magnet_forearm_y",
"mytrain$magnet_belt_z", "mytrain$magnet_arm_z", "mytrain$magnet_dumbbell_z", "mytrain$magnet_forearm_z")]
mytrainraw <- mytrain[,"mytrain$classe", "mytrain$roll_belt", "mytrain$roll_arm", "mytrain$roll_dumbbell", "mytrain$roll_forearm",
"mytrain$pitch_belt", "mytrain$pitch_arm", "mytrain$pitch_dumbbell", "mytrain$pitch_forearm",
"mytrain$yaw_belt", "mytrain$yaw_arm", "mytrain$yaw_dumbbell", "mytrain$yaw_forearm",
"mytrain$amplitude_roll_belt", "mytrain$amplitude_roll_arm", "mytrain$amplitude_roll_dumbbell", "mytrain$amplitude_roll_forearm",
"mytrain$amplitude_pitch_belt", "mytrain$amplitude_pitch_arm", "mytrain$amlitude_pitch_dumbbell", "mytrain$amplitude_pitch_forearm",
"mytrain$amplitude_yaw_belt", "mytrain$amplitude_yaw_arm", "mytrain$amlitude_yaw_dumbbell", "mytrain$amplitude_yaw_forearm",
"mytrain$gyros_belt_x", "mytrain$gyros_arm_x", "mytrain$gyros_dumbbell_x", "mytrain$gyros_forearm_x",
"mytrain$gyros_belt_y", "mytrain$gyros_arm_y", "mytrain$gyros_dumbbell_y", "mytrain$gyros_forearm_y",
"mytrain$gyros_belt_z", "mytrain$gyros_arm_z", "mytrain$gyros_dumbbell_z", "mytrain$gyros_forearm_z",
"mytrain$accel_belt_x", "mytrain$accel_arm_x", "mytrain$accel_dumbbell_x", "mytrain$accel_forearm_x",
"mytrain$accel_belt_y", "mytrain$accel_arm_y", "mytrain$accel_dumbbell_y", "mytrain$accel_forearm_y",
"mytrain$accel_belt_z", "mytrain$accel_arm_z", "mytrain$accel_dumbbell_z", "mytrain$accel_forearm_z",
"mytrain$magnet_belt_x", "mytrain$magnet_arm_x", "mytrain$magnet_dumbbell_x", "mytrain$magnet_forearm_x",
"mytrain$magnet_belt_y", "mytrain$magnet_arm_y", "mytrain$magnet_dumbbell_y", "mytrain$magnet_forearm_y",
"mytrain$magnet_belt_z", "mytrain$magnet_arm_z", "mytrain$magnet_dumbbell_z", "mytrain$magnet_forearm_z"]
mytrainraw <- mytrain["mytrain$classe", "mytrain$roll_belt", "mytrain$roll_arm", "mytrain$roll_dumbbell", "mytrain$roll_forearm",
"mytrain$pitch_belt", "mytrain$pitch_arm", "mytrain$pitch_dumbbell", "mytrain$pitch_forearm",
"mytrain$yaw_belt", "mytrain$yaw_arm", "mytrain$yaw_dumbbell", "mytrain$yaw_forearm",
"mytrain$amplitude_roll_belt", "mytrain$amplitude_roll_arm", "mytrain$amplitude_roll_dumbbell", "mytrain$amplitude_roll_forearm",
"mytrain$amplitude_pitch_belt", "mytrain$amplitude_pitch_arm", "mytrain$amlitude_pitch_dumbbell", "mytrain$amplitude_pitch_forearm",
"mytrain$amplitude_yaw_belt", "mytrain$amplitude_yaw_arm", "mytrain$amlitude_yaw_dumbbell", "mytrain$amplitude_yaw_forearm",
"mytrain$gyros_belt_x", "mytrain$gyros_arm_x", "mytrain$gyros_dumbbell_x", "mytrain$gyros_forearm_x",
"mytrain$gyros_belt_y", "mytrain$gyros_arm_y", "mytrain$gyros_dumbbell_y", "mytrain$gyros_forearm_y",
"mytrain$gyros_belt_z", "mytrain$gyros_arm_z", "mytrain$gyros_dumbbell_z", "mytrain$gyros_forearm_z",
"mytrain$accel_belt_x", "mytrain$accel_arm_x", "mytrain$accel_dumbbell_x", "mytrain$accel_forearm_x",
"mytrain$accel_belt_y", "mytrain$accel_arm_y", "mytrain$accel_dumbbell_y", "mytrain$accel_forearm_y",
"mytrain$accel_belt_z", "mytrain$accel_arm_z", "mytrain$accel_dumbbell_z", "mytrain$accel_forearm_z",
"mytrain$magnet_belt_x", "mytrain$magnet_arm_x", "mytrain$magnet_dumbbell_x", "mytrain$magnet_forearm_x",
"mytrain$magnet_belt_y", "mytrain$magnet_arm_y", "mytrain$magnet_dumbbell_y", "mytrain$magnet_forearm_y",
"mytrain$magnet_belt_z", "mytrain$magnet_arm_z", "mytrain$magnet_dumbbell_z", "mytrain$magnet_forearm_z"]
mytrainraw <- mytrain[orig]
orig <- c("classe", "roll_belt", "roll_arm", "roll_dumbbell", "roll_forearm",
"mytrain$pitch_belt", "mytrain$pitch_arm", "mytrain$pitch_dumbbell", "mytrain$pitch_forearm",
"mytrain$yaw_belt", "mytrain$yaw_arm", "mytrain$yaw_dumbbell", "mytrain$yaw_forearm",
"mytrain$amplitude_roll_belt", "mytrain$amplitude_roll_arm", "mytrain$amplitude_roll_dumbbell", "mytrain$amplitude_roll_forearm",
"mytrain$amplitude_pitch_belt", "mytrain$amplitude_pitch_arm", "mytrain$amlitude_pitch_dumbbell", "mytrain$amplitude_pitch_forearm",
"mytrain$amplitude_yaw_belt", "mytrain$amplitude_yaw_arm", "mytrain$amlitude_yaw_dumbbell", "mytrain$amplitude_yaw_forearm",
"mytrain$gyros_belt_x", "mytrain$gyros_arm_x", "mytrain$gyros_dumbbell_x", "mytrain$gyros_forearm_x",
"mytrain$gyros_belt_y", "mytrain$gyros_arm_y", "mytrain$gyros_dumbbell_y", "mytrain$gyros_forearm_y",
"mytrain$gyros_belt_z", "mytrain$gyros_arm_z", "mytrain$gyros_dumbbell_z", "mytrain$gyros_forearm_z",
"mytrain$accel_belt_x", "mytrain$accel_arm_x", "mytrain$accel_dumbbell_x", "mytrain$accel_forearm_x",
"mytrain$accel_belt_y", "mytrain$accel_arm_y", "mytrain$accel_dumbbell_y", "mytrain$accel_forearm_y",
"mytrain$accel_belt_z", "mytrain$accel_arm_z", "mytrain$accel_dumbbell_z", "mytrain$accel_forearm_z",
"mytrain$magnet_belt_x", "mytrain$magnet_arm_x", "mytrain$magnet_dumbbell_x", "mytrain$magnet_forearm_x",
"mytrain$magnet_belt_y", "mytrain$magnet_arm_y", "mytrain$magnet_dumbbell_y", "mytrain$magnet_forearm_y",
"mytrain$magnet_belt_z", "mytrain$magnet_arm_z", "mytrain$magnet_dumbbell_z", "mytrain$magnet_forearm_z")
mytrainraw <- mytrain[orig]
mytrainraw <- mytrain[,orig]
sub_df=subset(mytrain,select = orig)
df.1 <- mytrain[,mytrain$classe]
df <- mytrain
df.1 <- df[,c("classe")]
df.1 <- df[,c("classe", "roll_belt")]
orig <- c("classe", "roll_belt", "roll_arm", "roll_dumbbell", "roll_forearm",
"pitch_belt", "pitch_arm", "pitch_dumbbell", "pitch_forearm",
"yaw_belt", "yaw_arm", "yaw_dumbbell", "yaw_forearm",
"amplitude_roll_belt", "amplitude_roll_arm", "amplitude_roll_dumbbell", "amplitude_roll_forearm",
"amplitude_pitch_belt", "amplitude_pitch_arm", "amlitude_pitch_dumbbell", "amplitude_pitch_forearm",
"amplitude_yaw_belt", "amplitude_yaw_arm", "amlitude_yaw_dumbbell", "amplitude_yaw_forearm",
"gyros_belt_x", "gyros_arm_x", "gyros_dumbbell_x", "gyros_forearm_x",
"gyros_belt_y", "gyros_arm_y", "gyros_dumbbell_y", "gyros_forearm_y",
"gyros_belt_z", "gyros_arm_z", "gyros_dumbbell_z", "gyros_forearm_z",
"accel_belt_x", "accel_arm_x", "accel_dumbbell_x", "accel_forearm_x",
"accel_belt_y", "accel_arm_y", "accel_dumbbell_y", "accel_forearm_y",
"accel_belt_z", "accel_arm_z", "accel_dumbbell_z", "accel_forearm_z",
"magnet_belt_x", "magnet_arm_x", "magnet_dumbbell_x", "magnet_forearm_x",
"magnet_belt_y", "magnet_arm_y", "magnet_dumbbell_y", "magnet_forearm_y",
"magnet_belt_z", "magnet_arm_z", "magnet_dumbbell_z", "magnet_forearm_z")
mytrainraw <- mytrain[,orig]
names(mytrain)
mytrainraw <- mytrain[,orig]
## Get training data
trainURL <- "http://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv"
training <- read.csv(url(trainURL), na.strings=c("NA","#DIV/0!",""), stringsAsFactors = FALSE)
## Get training data
trainURL <- "http://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv"
training <- read.csv(url(trainURL), na.strings=c("NA","#DIV/0!",""), stringsAsFactors = FALSE)
library(ISLR); library(ggplot2); library(caret)
data <- data.frame(training)
myinTrain <- createDataPartition(y=data$classe, p=0.7, list=FALSE)
mytrain <- data[myinTrain,]
mytest <- data[-myinTrain,]
dim(mytrain); dim(mytest)
names(mytrain)
vars <- c("classe", "roll_belt", "roll_arm", "roll_dumbbell", "roll_forearm",
"pitch_belt", "pitch_arm", "pitch_dumbbell", "pitch_forearm",
"yaw_belt", "yaw_arm", "yaw_dumbbell", "yaw_forearm",
"amplitude_roll_belt", "amplitude_roll_arm", "amplitude_roll_dumbbell", "amplitude_roll_forearm",
"amplitude_pitch_belt", "amplitude_pitch_arm", "amlitude_pitch_dumbbell", "amplitude_pitch_forearm",
"amplitude_yaw_belt", "amplitude_yaw_arm", "amlitude_yaw_dumbbell", "amplitude_yaw_forearm",
"gyros_belt_x", "gyros_arm_x", "gyros_dumbbell_x", "gyros_forearm_x",
"gyros_belt_y", "gyros_arm_y", "gyros_dumbbell_y", "gyros_forearm_y",
"gyros_belt_z", "gyros_arm_z", "gyros_dumbbell_z", "gyros_forearm_z",
"accel_belt_x", "accel_arm_x", "accel_dumbbell_x", "accel_forearm_x",
"accel_belt_y", "accel_arm_y", "accel_dumbbell_y", "accel_forearm_y",
"accel_belt_z", "accel_arm_z", "accel_dumbbell_z", "accel_forearm_z",
"magnet_belt_x", "magnet_arm_x", "magnet_dumbbell_x", "magnet_forearm_x",
"magnet_belt_y", "magnet_arm_y", "magnet_dumbbell_y", "magnet_forearm_y",
"magnet_belt_z", "magnet_arm_z", "magnet_dumbbell_z", "magnet_forearm_z")
mytrainraw <- mytrain[,vars]
mytrainraw <- mytrain[,c("classe")]
mytrainraw <- mytrain[,c("classe", "roll_belt")]
mytrainraw <- mytrain[,c("classe", "roll_belt", "roll_arm", "roll_dumbbell", "roll_forearm")]
mytrainraw <- mytrain[,c("classe", "roll_belt", "roll_arm", "roll_dumbbell", "roll_forearm",
"pitch_belt", "pitch_arm", "pitch_dumbbell", "pitch_forearm",)]
mytrainraw <- mytrain[,c("classe", "roll_belt", "roll_arm", "roll_dumbbell", "roll_forearm",
"pitch_belt", "pitch_arm", "pitch_dumbbell", "pitch_forearm")]
mytrainraw <- mytrain[,c("classe", "roll_belt", "roll_arm", "roll_dumbbell", "roll_forearm",
"pitch_belt", "pitch_arm", "pitch_dumbbell", "pitch_forearm",
"yaw_belt", "yaw_arm", "yaw_dumbbell", "yaw_forearm")]
mytrainraw <- mytrain[,c("classe", "roll_belt", "roll_arm", "roll_dumbbell", "roll_forearm",
"pitch_belt", "pitch_arm", "pitch_dumbbell", "pitch_forearm",
"yaw_belt", "yaw_arm", "yaw_dumbbell", "yaw_forearm",
"amplitude_roll_belt", "amplitude_roll_arm", "amplitude_roll_dumbbell", "amplitude_roll_forearm")]
mytrainraw <- mytrain[,c("classe", "roll_belt", "roll_arm", "roll_dumbbell", "roll_forearm",
"pitch_belt", "pitch_arm", "pitch_dumbbell", "pitch_forearm",
"yaw_belt", "yaw_arm", "yaw_dumbbell", "yaw_forearm",
"amplitude_roll_belt", "amplitude_roll_arm", "amplitude_roll_dumbbell", "amplitude_roll_forearm",
"amplitude_pitch_belt", "amplitude_pitch_arm", "amlitude_pitch_dumbbell", "amplitude_pitch_forearm")]
vars <- c("classe", "roll_belt", "roll_arm", "roll_dumbbell", "roll_forearm",
"pitch_belt", "pitch_arm", "pitch_dumbbell", "pitch_forearm",
"yaw_belt", "yaw_arm", "yaw_dumbbell", "yaw_forearm",
"amplitude_roll_belt", "amplitude_roll_arm", "amplitude_roll_dumbbell", "amplitude_roll_forearm",
"amplitude_pitch_belt", "amplitude_pitch_arm", "amplitude_pitch_dumbbell", "amplitude_pitch_forearm",
"amplitude_yaw_belt", "amplitude_yaw_arm", "amplitude_yaw_dumbbell", "amplitude_yaw_forearm",
"gyros_belt_x", "gyros_arm_x", "gyros_dumbbell_x", "gyros_forearm_x",
"gyros_belt_y", "gyros_arm_y", "gyros_dumbbell_y", "gyros_forearm_y",
"gyros_belt_z", "gyros_arm_z", "gyros_dumbbell_z", "gyros_forearm_z",
"accel_belt_x", "accel_arm_x", "accel_dumbbell_x", "accel_forearm_x",
"accel_belt_y", "accel_arm_y", "accel_dumbbell_y", "accel_forearm_y",
"accel_belt_z", "accel_arm_z", "accel_dumbbell_z", "accel_forearm_z",
"magnet_belt_x", "magnet_arm_x", "magnet_dumbbell_x", "magnet_forearm_x",
"magnet_belt_y", "magnet_arm_y", "magnet_dumbbell_y", "magnet_forearm_y",
"magnet_belt_z", "magnet_arm_z", "magnet_dumbbell_z", "magnet_forearm_z")
df <- mytrain[,vars]
## Get training data
trainURL <- "http://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv"
training <- read.csv(url(trainURL), na.strings=c("NA","#DIV/0!",""), stringsAsFactors = FALSE)
library(ISLR); library(ggplot2); library(caret)
data <- data.frame(training)
myinTrain <- createDataPartition(y=data$classe, p=0.7, list=FALSE)
mytrain <- data[myinTrain,]
mytest <- data[-myinTrain,]
dim(mytrain); dim(mytest)
names(mytrain)
orig <- c("classe", "roll_belt", "roll_arm", "roll_dumbbell", "roll_forearm",
"pitch_belt", "pitch_arm", "pitch_dumbbell", "pitch_forearm",
"yaw_belt", "yaw_arm", "yaw_dumbbell", "yaw_forearm",
"amplitude_roll_belt", "amplitude_roll_arm", "amplitude_roll_dumbbell", "amplitude_roll_forearm",
"amplitude_pitch_belt", "amplitude_pitch_arm", "amplitude_pitch_dumbbell", "amplitude_pitch_forearm",
"amplitude_yaw_belt", "amplitude_yaw_arm", "amplitude_yaw_dumbbell", "amplitude_yaw_forearm",
"gyros_belt_x", "gyros_arm_x", "gyros_dumbbell_x", "gyros_forearm_x",
"gyros_belt_y", "gyros_arm_y", "gyros_dumbbell_y", "gyros_forearm_y",
"gyros_belt_z", "gyros_arm_z", "gyros_dumbbell_z", "gyros_forearm_z",
"accel_belt_x", "accel_arm_x", "accel_dumbbell_x", "accel_forearm_x",
"accel_belt_y", "accel_arm_y", "accel_dumbbell_y", "accel_forearm_y",
"accel_belt_z", "accel_arm_z", "accel_dumbbell_z", "accel_forearm_z",
"magnet_belt_x", "magnet_arm_x", "magnet_dumbbell_x", "magnet_forearm_x",
"magnet_belt_y", "magnet_arm_y", "magnet_dumbbell_y", "magnet_forearm_y",
"magnet_belt_z", "magnet_arm_z", "magnet_dumbbell_z", "magnet_forearm_z")
mytrainraw <- mytrain[,orig]
summary(mytrainraw)
amplitude <- c("amplitude_roll_belt", "amplitude_roll_arm", "amplitude_roll_dumbbell", "amplitude_roll_forearm",
"amplitude_pitch_belt", "amplitude_pitch_arm", "amplitude_pitch_dumbbell", "amplitude_pitch_forearm",
"amplitude_yaw_belt", "amplitude_yaw_arm", "amplitude_yaw_dumbbell", "amplitude_yaw_forearm")
mytrainraw <- mytrainraw[,-amplitude]
mytrainraw <- mytrainraw[,-(amplitude)]
mytrainraw <- mytrainraw[,!amplitude]
amplitude <- names(mytrainraw %in% c("amplitude_roll_belt", "amplitude_roll_arm", "amplitude_roll_dumbbell", "amplitude_roll_forearm",
"amplitude_pitch_belt", "amplitude_pitch_arm", "amplitude_pitch_dumbbell", "amplitude_pitch_forearm",
"amplitude_yaw_belt", "amplitude_yaw_arm", "amplitude_yaw_dumbbell", "amplitude_yaw_forearm")
mytrainraw <- mytrainraw[,!amplitude]
mytrainraw <- mytrainraw[!amplitude]
amplitude <- names(mytrainraw) %in% c("amplitude_roll_belt", "amplitude_roll_arm", "amplitude_roll_dumbbell", "amplitude_roll_forearm",
"amplitude_pitch_belt", "amplitude_pitch_arm", "amplitude_pitch_dumbbell", "amplitude_pitch_forearm",
"amplitude_yaw_belt", "amplitude_yaw_arm", "amplitude_yaw_dumbbell", "amplitude_yaw_forearm")
mytrainraw <- mytrainraw[!amplitude]
summary(mytrainraw)
skewValues <- apply(mytrainraw[,-1], 2, skewness)
library(e1071)
skewValues <- apply(mytrainraw[,-1], 2, skewness)
head(skewValues)
skewValues
par(mfrow=c(4,4))
hist(mytrainraw$gyros_dumbbell_x, main = "gyros_dumbbell_x")
hist(mytrainraw$gyros_forearm_x, main = "gyros_forearm_x")
hist(mytrainraw$gyros_dumbbell_y, main = "gyros_dumbbell_y")
hist(mytrainraw$gyros_forearm_y, main = "gyros_forearm_y")
hist(mytrainraw$gyros_dumbbell_z, main = "gyros_dumbbell_z")
hist(mytrainraw$gyros_forearm_z, main = "gyros_forearm_z")
hist(mytrainraw$magnet_belt_y, main = "magnet_belt_y")
pzerogdx<- length(mytrainraw$gyros_dumbbell_x == 0)/length(mytrainraw$gyros_dumbbell_x)
length(mytrainraw$gyros_dumbbell_x == 0)/length(mytrainraw$gyros_dumbbell_x)
mytrainraw$gyros_dumbbell_x
pzerogdx<- length(mytrainraw[mytrainraw$gyros_dumbbell_x == 0,])/length(mytrainraw$gyros_dumbbell_x)
mytrainraw[mytrainraw$gyros_dumbbell_x == 0,]
pzerogdx<- length(mytrainraw[mytrainraw$gyros_dumbbell_x == 0.00,])/length(mytrainraw$gyros_dumbbell_x)
head(mytrainraw[mytrainraw$gyros_dumbbell_x == 0.00,])
pzerogfx<- length(mytrainraw[mytrainraw$gyros_forearm_x == 0.00,])/length(mytrainraw$gyros_forearm_x)
pzerogdy<- length(mytrainraw[mytrainraw$gyros_dumbbell_y == 0.00,])/length(mytrainraw$gyros_dumbbell_y)
head(mytrainraw[mytrainraw$gyros_dumbbell_y == 0.00,])
length(mytrainraw[mytrainraw$gyros_dumbbell_y == 0.00,])
pzerogfy<- length(mytrainraw[mytrainraw$gyros_forearm_y == 0.00,])/length(mytrainraw$gyros_forearm_y)
pzerogdz<- length(mytrainraw[mytrainraw$gyros_dumbbell_z == 0.00,])/length(mytrainraw$gyros_dumbbell_z)
pzerogdz<- length(mytrainraw[mytrainraw$gyros_forearm_z == 0.00,])/length(mytrainraw$gyros_forearm_z)
library(corrplot)
install.packages("corrplot")
library(corrplot)
correlations <- cor(mytrainraw[,-1])
dim(correlations)
library(corrplot)
corrplot(correlations, order = "hclust")
corrplot(correlations, order = "hclust")
pcaObj <- prcomp(mytrainraw[,-1], center = TRUE, scale. = TRUE)
percentVariance <- pcaObj$sdev^2/sum(pcaObj$sdev^2)*100
percentVariance
summary(percentVariance)
plot(pcaObj)
plot(prcomp(mytrainraw[,-1], center = TRUE, scale. = TRUE))
PC <- seq.int(pcaObj)
plot(PC, percentVariance)
percentVariance <- data.frame(pcaObj$sdev^2/sum(pcaObj$sdev^2)*100)
percentVariance$PC <- seq.int(percentVariance)
plot(percentVariance$PC, percentVariance[1])
correlations <- cor(mytrainraw[,-1])
dim(correlations)
library(corrplot)
corrplot(correlations, order = "hclust")
pcaObj <- prcomp(mytrainraw[,-1], center = TRUE, scale. = TRUE)
percentVariance <- data.frame(pcaObj$sdev^2/sum(pcaObj$sdev^2)*100)
percentVariance$PC <- seq.int(percentVariance)
plot(percentVariance$PC, percentVariance[1])
percentVariance$PC <- seq.len(percentVariance)
percentVariance$PC <- seq_len(percentVariance)
percentVariance$PC <- seq_along(percentVariance)
percentVariance <- pcaObj$sdev^2/sum(pcaObj$sdev^2)*100
seq(1, 6, by = 3)
PC <- seq(1:48, by = 1)
PC <- seq(1,48, by = 1)
Prince <- data.frame(PC, percentVariance)
plot(Prince$PC, Prince$percentVariance)
plot(Prince$PC, Prince$percentVariance, xlab = "Principle Component",
ylab = "Percent Variation")
par(mfrow=c(1,1))
plot(Prince$PC, Prince$percentVariance, xlab = "Principle Component",
ylab = "Percent Variation")
lines(stats::lowess(Prince))
lines(Prince$PC, Prince$percentVariance)
plot(Prince$PC, Prince$percentVariance, xlab = "Principle Component",
ylab = "Percent Variation")
lines(Prince$PC, Prince$percentVariance)
head(pcaObj$rotation[,1:2])
head(pcaObj$rotation[,1:3])
cor(mytrainraw[,-1])
nearZeroVar(mytrainraw[,-1])
library(e1071)
skewValues <- apply(mytrainraw[,-1], 2, skewness)
skewValues
par(mfrow=c(4,4))
hist(mytrainraw$gyros_dumbbell_x, main = "gyros_dumbbell_x")
hist(mytrainraw$gyros_forearm_x, main = "gyros_forearm_x")
hist(mytrainraw$gyros_dumbbell_y, main = "gyros_dumbbell_y")
hist(mytrainraw$gyros_forearm_y, main = "gyros_forearm_y")
hist(mytrainraw$gyros_dumbbell_z, main = "gyros_dumbbell_z")
hist(mytrainraw$gyros_forearm_z, main = "gyros_forearm_z")
hist(mytrainraw$magnet_belt_y, main = "magnet_belt_y")
set.seed(32323)
fitControl <- trainControl(method = "cv", number = 10)
modelFit <- train(classe ~ ., data=mytrainraw, method="glm", preProcess="pca",
trControl=fitControl)
modelFit
modelFit <- train(classe ~ ., data=mytrainraw, method="glm", preProcess="pca",
trControl=trainControl(preProcOptions=list(thresh=0.8)))
modelFit
trans <- preProcess(mytrainraw[,-1], method = c("pca"))
trans
transformed <- predict(trans, mytrainraw[,-1])
par(mfrow=c(1,1))
plot(pcaObj$x[,1],pcaObj$x[,2])
preProc <- preProcess(mytrainraw[,-1], method = "pca", pcaComp = 2)
trainPC <- predict(preProc, mytrainraw[,-1])
mod1 <- train(mytrainraw$classe ~ ., method="glm", data = trainPC)
mod1 <- train(factor(mytrainraw$classe) ~ ., method="glm", data = trainPC)
warnings()
names(getModelInfo())
install.packages("kknn")
library(kknn)
mod2 <- train.kknn(classe ~ ., data = trainPC, kmax = 9)
mod2 <- train.kknn(mytrainraw$classe ~ ., data = trainPC, kmax = 9)
dftrain <- data.frame(cbind(trainPC, mytrainraw[,1]))
mod2 <- train.kknn(classe ~ ., data = dftrain, kmax = 9)
names(dftrain)
mod2 <- train.kknn(dftrain[,3] ~ ., data = dftrain, kmax = 9)
mod2
prediction <- predict(mod2, mytest[,-160])
## LOAD DATA
## Get training data
trainURL <- "http://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv"
training <- read.csv(url(trainURL), na.strings=c("NA","#DIV/0!",""), stringsAsFactors = FALSE)
library(ISLR); library(ggplot2); library(caret)
data <- data.frame(training)
myinTrain <- createDataPartition(y=data$classe, p=0.6, list=FALSE)
mytrain <- data[myinTrain,]
mytest <- data[-myinTrain,]
dim(mytrain); dim(mytest)
names(mytrain)
orig <- c("classe", "roll_belt", "roll_arm", "roll_dumbbell", "roll_forearm",
"pitch_belt", "pitch_arm", "pitch_dumbbell", "pitch_forearm",
"yaw_belt", "yaw_arm", "yaw_dumbbell", "yaw_forearm",
"amplitude_roll_belt", "amplitude_roll_arm", "amplitude_roll_dumbbell", "amplitude_roll_forearm",
"amplitude_pitch_belt", "amplitude_pitch_arm", "amplitude_pitch_dumbbell", "amplitude_pitch_forearm",
"amplitude_yaw_belt", "amplitude_yaw_arm", "amplitude_yaw_dumbbell", "amplitude_yaw_forearm",
"gyros_belt_x", "gyros_arm_x", "gyros_dumbbell_x", "gyros_forearm_x",
"gyros_belt_y", "gyros_arm_y", "gyros_dumbbell_y", "gyros_forearm_y",
"gyros_belt_z", "gyros_arm_z", "gyros_dumbbell_z", "gyros_forearm_z",
"accel_belt_x", "accel_arm_x", "accel_dumbbell_x", "accel_forearm_x",
"accel_belt_y", "accel_arm_y", "accel_dumbbell_y", "accel_forearm_y",
"accel_belt_z", "accel_arm_z", "accel_dumbbell_z", "accel_forearm_z",
"magnet_belt_x", "magnet_arm_x", "magnet_dumbbell_x", "magnet_forearm_x",
"magnet_belt_y", "magnet_arm_y", "magnet_dumbbell_y", "magnet_forearm_y",
"magnet_belt_z", "magnet_arm_z", "magnet_dumbbell_z", "magnet_forearm_z")
mytrainraw <- mytrain[,orig]
summary(mytrainraw)
## REMOVE FEATURES THAT ARE MOSTLY NA
## The amplitude measurements are almost 100% NA and are removed from the dataset
amplitude <- names(mytrainraw) %in% c("amplitude_roll_belt", "amplitude_roll_arm", "amplitude_roll_dumbbell", "amplitude_roll_forearm",
"amplitude_pitch_belt", "amplitude_pitch_arm", "amplitude_pitch_dumbbell", "amplitude_pitch_forearm",
"amplitude_yaw_belt", "amplitude_yaw_arm", "amplitude_yaw_dumbbell", "amplitude_yaw_forearm")
mytrainraw <- mytrainraw[!amplitude]
summary(mytrainraw)
library(e1071)
skewValues <- apply(mytrainraw[,-1], 2, skewness)
skewValues
nearZeroVar(mytrainraw[,-1])
correlations <- cor(mytrainraw[,-1])
dim(correlations)
library(corrplot)
corrplot(correlations, order = "hclust")
highCorr <- findCorrelation(mytrainraw[,-1])
correlations <- cor(mytrainraw[,-1])
highCorr <- findCorrelation(correlations, cutoff = 0.75)
filteredmytrain <- mytrainraw[, -highCorr]
names(filteredmytrain)
keep <- names(filteredmytrain)
train < data.frame(mytrainraw$classe, filteredmytrain)
filteredmytrain <- mytrainraw[,mytrainraw[, -highCorr])
filteredmytrain <- mytrainraw[,-highCorr])
filtmytrain <- mytrainraw[,-highCorr]
keep <- names(filtmytrain)
names(keep)
keep
filtmytrain <- cbind(mytrainraw[,-highCorr], mytrainraw[,1])
keep <- names(filtmytrain)
keep
names(mytrainraw)
highCorr
mytrainraw[,-1]
names(mytrainraw[,-1])
filtmytrain <- mytrainraw[,c(!highCorr, "classe")]
filtmytrain <- mytrainraw[,c(-highCorr, "classe")]
filtmytrain <- mytrainraw[,-highCorr]
names(mytrainraw)
outcome <- mytrainraw[,1]
train <- cbind.data.frame(outcome, filtmytrain)
keep <- names(train)
keep
highCorr <- findCorrelation(abs(correlations), cutoff = 0.75)
filtmytrain <- mytrainraw[,-highCorr]
outcome <- mytrainraw[,1]
train <- cbind.data.frame(outcome, filtmytrain)
keep <- names(train)
keep
set.seed(1720)
fitControl <- trainControl(method = "cv")
modFit <- train(outcome ~ ., data = train, method = "knn", trControl = fitControl,
preProcess = c("center", "scale"))
plot(modFit)
modFit <- train(outcome ~ ., data = train, method = "knn", trControl = fitControl,
preProcess = c("center", "scale"), tuneLength = 20)
plot(modFit)
modFit
test <- mytest[,keep]
keep <- names(filtmytrain)
keep
test <- mytest[,keep]
mytestnew <- mytest[,keep]
preProc <- preProcess(train[,-1], method = c("center", "scale"))
fitControl <- trainControl(method = "cv")
trainPC <- predict(preProc, train[,-1])
fitControl <- trainControl(method = "cv")
trainCS <- predict(preProc, train[,-1])
fitControl <- trainControl(method = "cv")
modFit <- train(outcome ~ ., data = trainCS, method = "knn",
trControl = fitControl, tuneLength = 20)
modFit
plot(modFit)
names(mytest)
testClasse <- mytest[,160]
mytestnew <- mytest[,keep]
test <- cbind.data.frame(testClasse, mytestnew)
names(test)
names(train)
testPC <- predict(preProc, test[,-1])
testPC
names(testPC)
confusionMatrix(test$testClasse, predict(modFit, testPC))
## Get the test data
testURL <- "http://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv"
testing <- read.csv(url(testURL), na.strings=c("NA","#DIV/0!",""),
stringsAsFactors = FALSE)
names(testing)
head(testing$problem_id)
head(testing$X)
testingnew <- testing[,keep]
testingPC <- predict(preProc, testingnew)
print(predict(modFit, newdata = testingnew))
